{"ast":null,"code":"import React,{useState,useEffect,useRef,useCallback}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AnimeSearch(){const[query,setQuery]=useState('');const[results,setResults]=useState([]);const[isSearching,setIsSearching]=useState(false);const navigate=useNavigate();const abortControllerRef=useRef(null);const debounceTimerRef=useRef(null);// Cleanup on unmount\nuseEffect(()=>{return()=>{if(abortControllerRef.current){abortControllerRef.current.abort();}if(debounceTimerRef.current){clearTimeout(debounceTimerRef.current);}};},[]);const performSearch=useCallback(async searchQuery=>{if(!searchQuery.trim()){setResults([]);return;}// Abort previous request if exists\nif(abortControllerRef.current){abortControllerRef.current.abort();}// Create new abort controller\nabortControllerRef.current=new AbortController();setIsSearching(true);try{const response=await fetch(\"https://api.jikan.moe/v4/anime?q=\".concat(encodeURIComponent(searchQuery),\"&limit=10\"),{signal:abortControllerRef.current.signal});const data=await response.json();if(data.data){setResults(data.data.map(anime=>{var _anime$images,_anime$images$jpg;return{id:anime.mal_id,title:anime.title,image:(_anime$images=anime.images)===null||_anime$images===void 0?void 0:(_anime$images$jpg=_anime$images.jpg)===null||_anime$images$jpg===void 0?void 0:_anime$images$jpg.image_url,synopsis:anime.synopsis};}));}else{setResults([]);}}catch(error){if(error.name!=='AbortError'){setResults([]);}}finally{setIsSearching(false);}},[]);const handleSearch=e=>{e.preventDefault();performSearch(query);};// Debounced search on input change\nconst handleInputChange=e=>{const value=e.target.value;setQuery(value);// Clear existing timer\nif(debounceTimerRef.current){clearTimeout(debounceTimerRef.current);}// Set new timer for debounced search\ndebounceTimerRef.current=setTimeout(()=>{performSearch(value);},500);};return/*#__PURE__*/_jsxs(\"div\",{className:\"container my-4\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"row g-2 align-items-center mb-4\",onSubmit:handleSearch,children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-auto flex-grow-1\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Cerca un anime...\",value:query,onChange:handleInputChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-auto\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:isSearching,children:isSearching?'Cercando...':'Cerca'})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:results.map(anime=>/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 col-lg-4 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card h-100 shadow-sm\",style:{cursor:'pointer'},onClick:()=>navigate(\"/anime/\".concat(anime.id)),children:[anime.image&&/*#__PURE__*/_jsx(\"img\",{src:anime.image,alt:anime.title,className:\"card-img-top\",style:{objectFit:'cover',height:'250px'}}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",children:anime.title}),anime.synopsis&&/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",style:{fontSize:'0.95em',color:'#555'},children:[anime.synopsis.slice(0,180),\"...\"]})]})]})},anime.id))})]});}export default AnimeSearch;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useNavigate","jsx","_jsx","jsxs","_jsxs","AnimeSearch","query","setQuery","results","setResults","isSearching","setIsSearching","navigate","abortControllerRef","debounceTimerRef","current","abort","clearTimeout","performSearch","searchQuery","trim","AbortController","response","fetch","concat","encodeURIComponent","signal","data","json","map","anime","_anime$images","_anime$images$jpg","id","mal_id","title","image","images","jpg","image_url","synopsis","error","name","handleSearch","e","preventDefault","handleInputChange","value","target","setTimeout","className","children","onSubmit","type","placeholder","onChange","disabled","style","cursor","onClick","src","alt","objectFit","height","fontSize","color","slice"],"sources":["/home/runner/work/iAnime/iAnime/client/src/components/AnimeSearch.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nfunction AnimeSearch() {\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const navigate = useNavigate();\n  const abortControllerRef = useRef(null);\n  const debounceTimerRef = useRef(null);\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      if (debounceTimerRef.current) {\n        clearTimeout(debounceTimerRef.current);\n      }\n    };\n  }, []);\n\n  const performSearch = useCallback(async (searchQuery) => {\n    if (!searchQuery.trim()) {\n      setResults([]);\n      return;\n    }\n\n    // Abort previous request if exists\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n\n    // Create new abort controller\n    abortControllerRef.current = new AbortController();\n    setIsSearching(true);\n\n    try {\n      const response = await fetch(\n        `https://api.jikan.moe/v4/anime?q=${encodeURIComponent(searchQuery)}&limit=10`,\n        { signal: abortControllerRef.current.signal }\n      );\n      const data = await response.json();\n      if (data.data) {\n        setResults(data.data.map(anime => ({\n          id: anime.mal_id,\n          title: anime.title,\n          image: anime.images?.jpg?.image_url,\n          synopsis: anime.synopsis,\n        })));\n      } else {\n        setResults([]);\n      }\n    } catch (error) {\n      if (error.name !== 'AbortError') {\n        setResults([]);\n      }\n    } finally {\n      setIsSearching(false);\n    }\n  }, []);\n\n  const handleSearch = (e) => {\n    e.preventDefault();\n    performSearch(query);\n  };\n\n  // Debounced search on input change\n  const handleInputChange = (e) => {\n    const value = e.target.value;\n    setQuery(value);\n\n    // Clear existing timer\n    if (debounceTimerRef.current) {\n      clearTimeout(debounceTimerRef.current);\n    }\n\n    // Set new timer for debounced search\n    debounceTimerRef.current = setTimeout(() => {\n      performSearch(value);\n    }, 500);\n  };\n\n  return (\n    <div className=\"container my-4\">\n      <form className=\"row g-2 align-items-center mb-4\" onSubmit={handleSearch}>\n        <div className=\"col-auto flex-grow-1\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"Cerca un anime...\"\n            value={query}\n            onChange={handleInputChange}\n          />\n        </div>\n        <div className=\"col-auto\">\n          <button type=\"submit\" className=\"btn btn-primary\" disabled={isSearching}>\n            {isSearching ? 'Cercando...' : 'Cerca'}\n          </button>\n        </div>\n      </form>\n      <div className=\"row\">\n        {results.map((anime) => (\n          <div key={anime.id} className=\"col-md-6 col-lg-4 mb-4\">\n            <div className=\"card h-100 shadow-sm\" style={{cursor: 'pointer'}} onClick={() => navigate(`/anime/${anime.id}`)}>\n              {anime.image && (\n                <img src={anime.image} alt={anime.title} className=\"card-img-top\" style={{objectFit: 'cover', height: '250px'}} />\n              )}\n              <div className=\"card-body\">\n                <h5 className=\"card-title\">{anime.title}</h5>\n                {anime.synopsis && (\n                  <p className=\"card-text\" style={{fontSize: '0.95em', color: '#555'}}>{anime.synopsis.slice(0, 180)}...</p>\n                )}\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default AnimeSearch;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}